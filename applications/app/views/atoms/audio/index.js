!function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:function(){return d}});var r="AUDIO_ATOM",n="VIEW",a="READY",o="PLAY",i="25",u="50",c="75",l="end";function s(e){var t=function(e){return e.toFixed(0).padStart(2,"0")},r=Math.floor(e%60),n=Math.floor(e%3600/60),a=Math.floor(e/3600);return"".concat(t(a),":").concat(t(n),":").concat(t(r))}var d=function(e){var t=e.ophan,d=e.dom,p=e.viewport,y=e.consent,m=e.commercial;return function(e){var b,f,v,g=".atom--audio__player-element",A=function(t){return(b=t).playPauseButton.addEventListener("click",_),b.scrubber.addEventListener("input",T),b.scrubber.addEventListener("change",T),b.player.addEventListener("timeupdate",O),b.player.addEventListener("ended",x),b.player.addEventListener("durationchange",P),p.observe(e,1,w),f=Number(b.player.getAttribute("data-duration"))||1,v=b.player.getAttribute("data-media-id")||"",h(v,a),Promise.resolve()},S=function(){p.unobserve(e,1,w),b.playPauseButton.removeEventListener("click",_),b.scrubber.removeEventListener("input",T),b.scrubber.removeEventListener("change",T),b.player.removeEventListener("timeupdate",O),b.player.removeEventListener("ended",x),b=null},h=function(e,r){t.record({audio:{id:e,eventType:"audio:content:".concat(r)}})},E=function(e){d.write((function(){e.classList.remove("is-playing")}))},L=function(e,t,r,n){var a=getComputedStyle(e.scrubber).getPropertyValue("background-image").replace(/\d{1,3}%/gi,"".concat(t.toString(),"%"));d.write((function(){e.scrubber.value=t.toString(),e.player.setAttribute("data-last-tick",r.toString()),e.scrubber.style.backgroundImage=a,e.timePlayed.innerText=s(n)}))},P=function e(){b.timeDuration.innerText=s(b.player.duration),b.player.removeEventListener("durationchange",e),f=b.player.duration},O=function(){var e=Date.now(),t=b.player.getAttribute("data-last-tick");if(!(e-(Number(t)||0)<1e3)){var r=Math.floor(b.player.currentTime),n=Math.floor(r/f*100),a=b.player.getAttribute("data-milestones")||"";n>=25&&a.indexOf(i)<0&&(b.player.setAttribute("data-milestones",a.concat("".concat(i,","))),h(v,i)),n>=50&&a.indexOf(u)<0&&(b.player.setAttribute("data-milestones",a.concat("".concat(u,","))),h(v,u)),n>=75&&a.indexOf(c)<0&&(b.player.setAttribute("data-milestones",a.concat("".concat(c,","))),h(v,c)),L(b,n,e,r)}},_=function(){if(b.player.paused){var e=b.player.getAttribute("data-milestones")||"";e.indexOf(o)<0&&(b.player.setAttribute("data-milestones",e.concat("".concat(o,","))),h(v,o)),t=b.playPauseButton,d.write((function(){t.classList.add("is-playing")})),b.player.play()}else E(b.playPauseButton),b.player.pause();var t},w=function a(o){var i,u;o>=1&&(i=b.atomId,u=n,t.record({componentEvent:{component:{componentType:r,id:i,products:[],labels:[]},action:u}}),p.unobserve(e,1,a))},T=function(){var e=b.scrubber.value||0,t=Math.floor(f*e/100),r=Date.now();b.player.currentTime=t,L(b,e,r,t)},x=function(){var e=Date.now(),t=b.player.getAttribute("data-milestones")||"";t.indexOf(l)<0&&(h(v,l),b.player.setAttribute("data-milestones",t.concat("".concat(l,",")))),b.player.currentTime=f,E(b.playPauseButton),L(b,100,e,f)};return Object.freeze({runTry:function(){var t=e.querySelector(".atom--audio__button-playaudio"),r=e.querySelector(".atom--audio__progress-bar > input"),n=e.querySelector(".atom--audio"),a=e.querySelector(g),o=e.querySelector(".atom--audio__time-played > span"),i=e.querySelector(".atom--audio__time-duration > span");return m.isAdFree||y.onAcastConsentChange((function(t){var r=e.querySelector(g);if(r&&t){var n=r.getAttribute("src");n&&d.write((function(){r.setAttribute("src",n.replace("https://","https://flex.acast.com/"))}))}})),n&&a&&t&&o&&i&&r?Object.freeze({atomId:e.dataset.atomId,player:a,playPauseButton:t,timePlayed:o,timeDuration:i,scrubber:r,stop:S,start:function(){return A(this)}}):"Some elements were missing when initialising atom"}})}};exports.audio=t}();
