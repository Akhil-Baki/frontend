@import com.gu.commercial.branding.Branding
@import common.commercial.ContainerModel
@import common.{Edition, LinkTo, Localisation}
@import views.html.fragments.commercial.containerLogo
@import views.support.RenderClasses

@(containerDefinition: layout.FaciaContainer,
  frontProperties: model.FrontProperties,
  maybeContainerModel: Option[ContainerModel],
  showFrontBranding: Boolean,
  frontId: Option[String])(implicit request: RequestHeader)

@containerHeader(containerDefinition, frontProperties)

@if(showFrontBranding) {
    @for(commercial <- frontProperties.commercial; frontBranding <- commercial.branding(Edition(request))) {
        @containerLogo(frontBranding, isOnTheLeft = true)
    }
} else {
    @for(containerModel <- maybeContainerModel) {
        @for(containerBranding <- containerModel.branding) {
            @containerBranding match {
                case branding: Branding => { @containerLogo(branding, isOnTheLeft = true) }
                case _ => {}
            }
        }
    }
}

@for(containerLayout <- containerDefinition.containerLayout) {
    <div class="@RenderClasses(Map(
        ("fc-container__body", true),
        ("fc-container--rolled-up-hide", true),
        ("fc-show-more--hidden", containerDefinition.addShowMoreClasses),
        ("js-container--fc-show-more", containerDefinition.addShowMoreClasses),
        ("fc-show-more--mobile-only", containerDefinition.hasMobileOnlyShowMore)
    ))"
         data-title="@Localisation(containerDefinition.displayName getOrElse "")"
         data-id="@containerDefinition.dataId">

        @for(sliceWithCards <- containerLayout.slices) {
            @slice(sliceWithCards, containerDefinition.index, frontProperties = Some(frontProperties), containerDefinition.displayName, frontId, containerDefinition.isStoryPackage)
        }

        @if(containerDefinition.hasShowMore && containerDefinition.hasShowMoreEnabled) {
            @if(containerDefinition.useShowMore) {
                <div class="js-show-more-placeholder"></div>

                @showMoreButton(containerDefinition.displayName getOrElse "")
            } else {
                @* Don't hide any items, for on tag pages, which are chronological *@
                @showMore(
                    containerDefinition.containerLayout.map(_.remainingCards).getOrElse(Nil),
                    containerDefinition.index
                )
            }
        }

        @if(containerDefinition.href){
            @defining((containerDefinition.displayName, containerDefinition.href)) { case (title, href) =>
                @title.map { title =>
                    @defining(frontProperties.editorialType.contains("Contributor")) { isContributor =>

                        <div class="@RenderClasses(Map(
                            "fc-container__header__title" -> true,
                            "tone-comment" -> isContributor,
                            "tone-colour" -> isContributor))">
                            @href.map { href =>
                            <a data-link-name="section heading" href="@LinkTo {/@href}">
                                <button class="@RenderClasses(Map(
    ("button", true),
    ("button--medium", true),
    ("button--show-more", true),
    ("button--primary", true),
    ("collection__show-more", true),
    ("js-show-more-button", true),
    ("modern-visible", true)
))"
        data-test-id="show-more"
        data-link-name="more">
        <span class="js-button-text">See all @Localisation(title)</span>
</button>
                            </a>
                            }.getOrElse {
                                <button tabindex="0">@Localisation(title)</button>
                            }
                        </div>
                    }
                }
        }
        }

    </div>
}
